[tox]
requires = tox-conda
envlist = py37, py38, py39 #, py310
# isolated_build = True

# [travis]
# python =
#     3.8: py38
#     3.7: py37
#     3.6: py36

# [testenv:flake8]
# basepython = python
# deps = flake8
# commands = flake8 {{ cookiecutter.project_slug }} tests

[testenv]
# to use develop install
usedevelop = True
conda_env = environment.yml
conda_deps = pytest
commands =
    pytest {posargs}


[testenv:docs]
usedevelop = True
conda_env = environment.yaml
conda_deps =
           sphinx
           sphinx_rtd_theme
           nbsphinx
           sphinxcontrib-spelling
           ipython
deps = pyenchant
whitelist_externals =
                    bash
changedir=docs-nist-pages/html
commands =
         bash ./cleanup.sh
         sphinx-build  --color -b html -d "{envtmpdir}/doctrees" ../../docs .
         python -c 'import pathlib; print("documentation available under file://\{0\}".format(pathlib.Path(r"{toxinidir}") / "docs-nist-pages" / "html" / "index.html"))'


[testenv:build]
skip_install=True
conda_deps =
           setuptools
           setuptools-scm
           twine
           setuptools_scm_git_archive
           build
commands =
         python -m build --outdir "{envtmpdir}/dist"
         python -c 'print("upload with command twine upload {envtmpdir}/dist/*")'



[testenv:conda-build]
skip_install=True
conda_deps =
           greyskull
           conda-build
# changedir = {toxinidir}/conda-build
changedir = {envtmpdir}/conda-build
command =
        greyskull pypi {{ cookiecutter.project_slug }}
        python -c 'import pathlib: print(pathlib.Path(.))'
        conda-build .
